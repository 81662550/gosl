// Copyright 2016 The Gosl Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

package msh

import "github.com/cpmech/gosl/utl"

// Numeric constants
const (
	SQ3by5   = 0.7745966692414834 // sqrt(3.0 / 5.0)
	SQ19by30 = 0.7958224257542215 // sqrt(19.0 / 30.0)
	SQ19by33 = 0.7587869106393281 // sqrt(19.0 / 33.0)
)

// QuadPoint implements a quadrature (e.g. Gauss) point
type QuadPoint []float64 // length=4: [r, s, t, weight]

// QuadPoints is a set of quadrature points
type QuadPoints []QuadPoint

// constants
func init() {

	IntPoints = make(map[string]map[int]QuadPoints)

	IntPoints["lin"] = map[int]QuadPoints{
		2: []QuadPoint{
			QuadPoint{-utl.SQ3 / 3.0, 0.0, 0.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, 0.0, 0.0, 1.0},
		},
		3: []QuadPoint{
			QuadPoint{-SQ3by5, 0.0, 0.0, 5.0 / 9.0},
			QuadPoint{0.0, 0.0, 0.0, 8.0 / 9.0},
			QuadPoint{SQ3by5, 0.0, 0.0, 5.0 / 9.0},
		},
		5: []QuadPoint{
			QuadPoint{-0.906179845938663992797627e+00, 0.0, 0.0, 0.23692688505618908751426e+00},
			QuadPoint{-0.538469310105683091036314e+00, 0.0, 0.0, 0.47862867049936646804129e+00},
			QuadPoint{0.000000000000000000000000e+00, 0.0, 0.0, 0.56888888888888888888889e+00},
			QuadPoint{0.538469310105683091036314e+00, 0.0, 0.0, 0.47862867049936646804129e+00},
			QuadPoint{0.906179845938663992797627e+00, 0.0, 0.0, 0.23692688505618908751426e+00},
		},
	}

	IntPoints["tri"] = map[int]QuadPoints{
		1: []QuadPoint{
			QuadPoint{1.0 / 3.0, 1.0 / 3.0, 0.0, 1.0 / 2.0},
		},

		3: []QuadPoint{
			QuadPoint{1.0 / 6.0, 1.0 / 6.0, 0.0, 1.0 / 6.0},
			QuadPoint{2.0 / 3.0, 1.0 / 6.0, 0.0, 1.0 / 6.0},
			QuadPoint{1.0 / 6.0, 2.0 / 3.0, 0.0, 1.0 / 6.0},
		},
		12: []QuadPoint{
			QuadPoint{0.873821971016996, 0.063089014491502, 0, 0.0254224531851035},
			QuadPoint{0.063089014491502, 0.873821971016996, 0, 0.0254224531851035},
			QuadPoint{0.063089014491502, 0.063089014491502, 0, 0.0254224531851035},
			QuadPoint{0.501426509658179, 0.249286745170910, 0, 0.0583931378631895},
			QuadPoint{0.249286745170910, 0.501426509658179, 0, 0.0583931378631895},
			QuadPoint{0.249286745170910, 0.249286745170910, 0, 0.0583931378631895},
			QuadPoint{0.053145049844817, 0.310352451033784, 0, 0.041425537809187},
			QuadPoint{0.310352451033784, 0.053145049844817, 0, 0.041425537809187},
			QuadPoint{0.053145049844817, 0.636502499121398, 0, 0.041425537809187},
			QuadPoint{0.310352451033784, 0.636502499121398, 0, 0.041425537809187},
			QuadPoint{0.636502499121398, 0.053145049844817, 0, 0.041425537809187},
			QuadPoint{0.636502499121398, 0.310352451033784, 0, 0.041425537809187},
		},
		16: []QuadPoint{
			QuadPoint{3.33333333333333E-01, 3.33333333333333E-01, 0.0, 7.21578038388935E-02},
			QuadPoint{8.14148234145540E-02, 4.59292588292723E-01, 0.0, 4.75458171336425E-02},
			QuadPoint{4.59292588292723E-01, 8.14148234145540E-02, 0.0, 4.75458171336425E-02},
			QuadPoint{4.59292588292723E-01, 4.59292588292723E-01, 0.0, 4.75458171336425E-02},
			QuadPoint{6.58861384496480E-01, 1.70569307751760E-01, 0.0, 5.16086852673590E-02},
			QuadPoint{1.70569307751760E-01, 6.58861384496480E-01, 0.0, 5.16086852673590E-02},
			QuadPoint{1.70569307751760E-01, 1.70569307751760E-01, 0.0, 5.16086852673590E-02},
			QuadPoint{8.98905543365938E-01, 5.05472283170310E-02, 0.0, 1.62292488115990E-02},
			QuadPoint{5.05472283170310E-02, 8.98905543365938E-01, 0.0, 1.62292488115990E-02},
			QuadPoint{5.05472283170310E-02, 5.05472283170310E-02, 0.0, 1.62292488115990E-02},
			QuadPoint{8.39477740995800E-03, 2.63112829634638E-01, 0.0, 1.36151570872175E-02},
			QuadPoint{7.28492392955404E-01, 8.39477740995800E-03, 0.0, 1.36151570872175E-02},
			QuadPoint{2.63112829634638E-01, 7.28492392955404E-01, 0.0, 1.36151570872175E-02},
			QuadPoint{8.39477740995800E-03, 7.28492392955404E-01, 0.0, 1.36151570872175E-02},
			QuadPoint{7.28492392955404E-01, 2.63112829634638E-01, 0.0, 1.36151570872175E-02},
			QuadPoint{2.63112829634638E-01, 8.39477740995800E-03, 0.0, 1.36151570872175E-02},
		},
	}

	IntPoints["qua"] = map[int]QuadPoints{
		4: []QuadPoint{
			QuadPoint{-utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 0.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 0.0, 1.0},
			QuadPoint{-utl.SQ3 / 3.0, utl.SQ3 / 3.0, 0.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, utl.SQ3 / 3.0, 0.0, 1.0},
		},
		9: []QuadPoint{
			QuadPoint{-SQ3by5, -SQ3by5, 0.0, 25.0 / 81.0},
			QuadPoint{0.0, -SQ3by5, 0.0, 40.0 / 81.0},
			QuadPoint{SQ3by5, -SQ3by5, 0.0, 25.0 / 81.0},
			QuadPoint{-SQ3by5, 0.0, 0.0, 40.0 / 81.0},
			QuadPoint{0.0, 0.0, 0.0, 64.0 / 81.0},
			QuadPoint{SQ3by5, 0.0, 0.0, 40.0 / 81.0},
			QuadPoint{-SQ3by5, SQ3by5, 0.0, 25.0 / 81.0},
			QuadPoint{0.0, SQ3by5, 0.0, 40.0 / 81.0},
			QuadPoint{SQ3by5, SQ3by5, 0.0, 25.0 / 81.0},
		},
	}

	IntPoints["tet"] = map[int]QuadPoints{
		1: []QuadPoint{
			QuadPoint{1.0 / 4.0, 1.0 / 4.0, 1.0 / 4.0, 1.0 / 6.0},
		},
		4: []QuadPoint{
			QuadPoint{(5.0 + 3.0*utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, 1.0 / 24},
			QuadPoint{(5.0 - utl.SQ5) / 20.0, (5.0 + 3.0*utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, 1.0 / 24},
			QuadPoint{(5.0 - utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, (5.0 + 3.0*utl.SQ5) / 20.0, 1.0 / 24},
			QuadPoint{(5.0 - utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, (5.0 - utl.SQ5) / 20.0, 1.0 / 24},
		},
		5: []QuadPoint{
			QuadPoint{1.0 / 4.0, 1.0 / 4.0, 1.0 / 4.0, -2.0 / 15.0},
			QuadPoint{1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0, 3.0 / 40.0},
			QuadPoint{1.0 / 6.0, 1.0 / 6.0, 1.0 / 2.0, 3.0 / 40.0},
			QuadPoint{1.0 / 6.0, 1.0 / 2.0, 1.0 / 6.0, 3.0 / 40.0},
			QuadPoint{1.0 / 2.0, 1.0 / 6.0, 1.0 / 6.0, 3.0 / 40.0},
		},
		6: []QuadPoint{
			QuadPoint{1.0, 0.0, 0.0, 4.0 / 3.0},
			QuadPoint{-1.0, 0.0, 0.0, 4.0 / 3.0},
			QuadPoint{0.0, 1.0, 0.0, 4.0 / 3.0},
			QuadPoint{0.0, -1.0, 0.0, 4.0 / 3.0},
			QuadPoint{0.0, 0.0, 1.0, 4.0 / 3.0},
			QuadPoint{0.0, 0.0, -1.0, 4.0 / 3.0},
		},
	}

	IntPoints["hex"] = map[int]QuadPoints{
		8: []QuadPoint{
			QuadPoint{-utl.SQ3 / 3.0, -utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, -utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 1.0},
			QuadPoint{-utl.SQ3 / 3.0, utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, utl.SQ3 / 3.0, -utl.SQ3 / 3.0, 1.0},
			QuadPoint{-utl.SQ3 / 3.0, -utl.SQ3 / 3.0, utl.SQ3 / 3.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, -utl.SQ3 / 3.0, utl.SQ3 / 3.0, 1.0},
			QuadPoint{-utl.SQ3 / 3.0, utl.SQ3 / 3.0, utl.SQ3 / 3.0, 1.0},
			QuadPoint{utl.SQ3 / 3.0, utl.SQ3 / 3.0, utl.SQ3 / 3.0, 1.0},
		},
		14: []QuadPoint{
			QuadPoint{SQ19by30, 0.0, 0.0, 320.0 / 361.0},
			QuadPoint{-SQ19by30, 0.0, 0.0, 320.0 / 361.0},
			QuadPoint{0.0, SQ19by30, 0.0, 320.0 / 361.0},
			QuadPoint{0.0, -SQ19by30, 0.0, 320.0 / 361.0},
			QuadPoint{0.0, 0.0, SQ19by30, 320.0 / 361.0},
			QuadPoint{0.0, 0.0, -SQ19by30, 320.0 / 361.0},
			QuadPoint{SQ19by33, SQ19by33, SQ19by33, 121.0 / 361.0},
			QuadPoint{-SQ19by33, SQ19by33, SQ19by33, 121.0 / 361.0},
			QuadPoint{SQ19by33, -SQ19by33, SQ19by33, 121.0 / 361.0},
			QuadPoint{-SQ19by33, -SQ19by33, SQ19by33, 121.0 / 361.0},
			QuadPoint{SQ19by33, SQ19by33, -SQ19by33, 121.0 / 361.0},
			QuadPoint{-SQ19by33, SQ19by33, -SQ19by33, 121.0 / 361.0},
			QuadPoint{SQ19by33, -SQ19by33, -SQ19by33, 121.0 / 361.0},
			QuadPoint{-SQ19by33, -SQ19by33, -SQ19by33, 121.0 / 361.0},
		},
		27: []QuadPoint{
			QuadPoint{-0.774596669241483, -0.774596669241483, -0.774596669241483, 0.171467764060357},
			QuadPoint{0.000000000000000, -0.774596669241483, -0.774596669241483, 0.274348422496571},
			QuadPoint{0.774596669241483, -0.774596669241483, -0.774596669241483, 0.171467764060357},
			QuadPoint{-0.774596669241483, 0.000000000000000, -0.774596669241483, 0.274348422496571},
			QuadPoint{0.000000000000000, 0.000000000000000, -0.774596669241483, 0.438957475994513},
			QuadPoint{0.774596669241483, 0.000000000000000, -0.774596669241483, 0.274348422496571},
			QuadPoint{-0.774596669241483, 0.774596669241483, -0.774596669241483, 0.171467764060357},
			QuadPoint{0.000000000000000, 0.774596669241483, -0.774596669241483, 0.274348422496571},
			QuadPoint{0.774596669241483, 0.774596669241483, -0.774596669241483, 0.171467764060357},
			QuadPoint{-0.774596669241483, -0.774596669241483, 0.000000000000000, 0.274348422496571},
			QuadPoint{0.000000000000000, -0.774596669241483, 0.000000000000000, 0.438957475994513},
			QuadPoint{0.774596669241483, -0.774596669241483, 0.000000000000000, 0.274348422496571},
			QuadPoint{-0.774596669241483, 0.000000000000000, 0.000000000000000, 0.438957475994513},
			QuadPoint{0.000000000000000, 0.000000000000000, 0.000000000000000, 0.702331961591221},
			QuadPoint{0.774596669241483, 0.000000000000000, 0.000000000000000, 0.438957475994513},
			QuadPoint{-0.774596669241483, 0.774596669241483, 0.000000000000000, 0.274348422496571},
			QuadPoint{0.000000000000000, 0.774596669241483, 0.000000000000000, 0.438957475994513},
			QuadPoint{0.774596669241483, 0.774596669241483, 0.000000000000000, 0.274348422496571},
			QuadPoint{-0.774596669241483, -0.774596669241483, 0.774596669241483, 0.171467764060357},
			QuadPoint{0.000000000000000, -0.774596669241483, 0.774596669241483, 0.274348422496571},
			QuadPoint{0.774596669241483, -0.774596669241483, 0.774596669241483, 0.171467764060357},
			QuadPoint{-0.774596669241483, 0.000000000000000, 0.774596669241483, 0.274348422496571},
			QuadPoint{0.000000000000000, 0.000000000000000, 0.774596669241483, 0.438957475994513},
			QuadPoint{0.774596669241483, 0.000000000000000, 0.774596669241483, 0.274348422496571},
			QuadPoint{-0.774596669241483, 0.774596669241483, 0.774596669241483, 0.171467764060357},
			QuadPoint{0.000000000000000, 0.774596669241483, 0.774596669241483, 0.274348422496571},
			QuadPoint{0.774596669241483, 0.774596669241483, 0.774596669241483, 0.171467764060357},
		},
	}
}
